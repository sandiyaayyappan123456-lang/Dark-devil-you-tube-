<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anime Streamer - Episode Rows</title>
    <style>
        :root {
            --cr-orange: #f47521;
            --cr-black: #141519;
            --cr-gray: #23252b;
            --star-gold: #ffcc00;
        }

        body {
            margin: 0;
            font-family: 'Segoe UI', sans-serif;
            background-color: var(--cr-black);
            color: white;
            overflow-x: hidden;
        }

        nav { background: var(--cr-black); padding: 15px 5%; border-bottom: 1px solid #333; }
        .logo { color: var(--cr-orange); font-weight: bold; font-size: 1.5rem; cursor: pointer; }

        .page { display: none; padding: 20px 5%; }
        .active { display: block; }

        /* Admin Panel */
        .admin-panel { background: var(--cr-gray); padding: 15px; border-radius: 8px; margin-bottom: 20px; display: flex; gap: 10px; align-items: center; flex-wrap: wrap; }

        /* Grid for Home */
        .anime-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 20px; }
        .anime-card { cursor: pointer; background: var(--cr-gray); border-radius: 8px; overflow: hidden; transition: 0.3s; text-align: center; }
        .anime-card img { width: 100%; aspect-ratio: 2/3; object-fit: cover; }
        .anime-card p { padding: 8px; margin: 0; font-size: 14px; }

        /* Player Page Styling */
        .video-display { width: 100%; max-width: 900px; margin: 0 auto; background: #000; aspect-ratio: 16/9; border-radius: 8px; display: flex; align-items: center; justify-content: center; border: 1px solid #333; }
        video { width: 100%; height: 100%; border-radius: 8px; }

        /* Episode Row (Horizontal Scrolling) */
        .episode-row {
            display: flex;
            gap: 15px;
            overflow-x: auto;
            padding: 10px 0;
            margin-top: 20px;
        }
        .episode-row::-webkit-scrollbar { height: 8px; }
        .episode-row::-webkit-scrollbar-thumb { background: var(--cr-orange); border-radius: 10px; }

        .episode-card {
            min-width: 180px;
            background: var(--cr-gray);
            border-radius: 5px;
            cursor: pointer;
            text-align: center;
            padding: 10px;
            border: 2px solid transparent;
        }
        .episode-card:hover { border-color: var(--cr-orange); }
        .episode-card video { height: 80px; width: 100%; object-fit: cover; pointer-events: none; }

        .btn { background: var(--cr-orange); color: white; border: none; padding: 10px 15px; cursor: pointer; border-radius: 4px; font-weight: bold; }
        .rating-box { margin: 15px 0; font-size: 1.5rem; }
        .star { color: #444; cursor: pointer; }
        .star.selected { color: var(--star-gold); }
    </style>
</head>
<body>

<nav><div class="logo" onclick="showPage('homePage')">CRUNCHY-CLONE</div></nav>

<div id="homePage" class="page active">
    <div class="admin-panel">
        <strong>New Anime:</strong>
        <input type="text" id="newTitle" placeholder="Anime Title">
        <input type="file" id="newPoster" accept="image/*">
        <button class="btn" onclick="addNewAnime()">ADD TO HOME</button>
    </div>
    <h2 style="border-left: 4px solid var(--cr-orange); padding-left: 10px;">Browse Anime</h2>
    <div class="anime-grid" id="mainGrid"></div>
</div>

<div id="playerPage" class="page">
    <button onclick="showPage('homePage')" class="btn" style="background:#444; margin-bottom: 20px;">← Back</button>
    
    <div class="video-display" id="videoContainer">
        <p id="videoHint">Select an episode to start watching</p>
        <video id="mainPlayer" controls style="display:none;"></video>
    </div>

    <h1 id="currentAnimeTitle">Anime Name</h1>

    <div class="admin-panel" style="background: #1c1e22; border: 1px dashed var(--cr-orange);">
        <strong>Upload Episode:</strong>
        <input type="text" id="epName" placeholder="Ep Name (e.g. Ep 1)">
        <input type="file" id="epFile" accept="video/*">
        <button class="btn" onclick="addEpisode()">UPLOAD TO ROW</button>
    </div>

    <h3>Episodes</h3>
    <div class="episode-row" id="episodeList">
        </div>

    <div class="rating-box">
        <span class="star" onclick="setRating(1)">★</span>
        <span class="star" onclick="setRating(2)">★</span>
        <span class="star" onclick="setRating(3)">★</span>
        <span class="star" onclick="setRating(4)">★</span>
        <span class="star" onclick="setRating(5)">★</span>
    </div>
</div>

<script>
    let animeData = [];

    function showPage(pageId) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.getElementById(pageId).classList.add('active');
        if(pageId === 'homePage') document.getElementById('mainPlayer').pause();
    }

    function addNewAnime() {
        const title = document.getElementById('newTitle').value;
        const poster = document.getElementById('newPoster').files[0];
        if(!title || !poster) return alert("Fill all fields!");

        const anime = { title: title, poster: URL.createObjectURL(poster), episodes: [] };
        animeData.push(anime);
        renderHome();
    }

    function renderHome() {
        const grid = document.getElementById('mainGrid');
        grid.innerHTML = '';
        animeData.forEach((anime, index) => {
            const card = document.createElement('div');
            card.className = 'anime-card';
            card.onclick = () => openAnime(index);
            card.innerHTML = `<img src="${anime.poster}"><p>${anime.title}</p>`;
            grid.appendChild(card);
        });
    }

    let activeAnimeIndex = null;

    function openAnime(index) {
        activeAnimeIndex = index;
        document.getElementById('currentAnimeTitle').innerText = animeData[index].title;
        renderEpisodes();
        showPage('playerPage');
        // Reset player
        document.getElementById('mainPlayer').style.display = 'none';
        document.getElementById('videoHint').style.display = 'block';
    }

    function addEpisode() {
        const name = document.getElementById('epName').value;
        const file = document.getElementById('epFile').files[0];
        if(!name || !file) return alert("Select video and name!");

        const epUrl = URL.createObjectURL(file);
        animeData[activeAnimeIndex].episodes.push({ name: name, url: epUrl });
        
        renderEpisodes();
        document.getElementById('epName').value = '';
        document.getElementById('epFile').value = '';
    }

    function renderEpisodes() {
        const row = document.getElementById('episodeList');
        row.innerHTML = '';
        animeData[activeAnimeIndex].episodes.forEach(ep => {
            const epCard = document.createElement('div');
            epCard.className = 'episode-card';
            epCard.onclick = () => playThis(ep.url);
            epCard.innerHTML = `<video src="${ep.url}"></video><strong>${ep.name}</strong>`;
            row.appendChild(epCard);
        });
    }

    function playThis(url) {
        const vp = document.getElementById('mainPlayer');
        vp.src = url;
        vp.style.display = 'block';
        document.getElementById('videoHint').style.display = 'none';
        vp.play();
    }

    function setRating(n) {
        document.querySelectorAll('.star').forEach((s, i) => s.classList.toggle('selected', i < n));
    }
</script>

</body>
</html>
